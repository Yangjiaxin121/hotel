(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49344ec4"],{"09f4":function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),Math.easeInOutQuad=function(e,t,a,o){return e/=o/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var o=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function i(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function r(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(e,t,a){var l=r(),s=e-l,n=20,u=0;t="undefined"===typeof t?500:t;var c=function e(){u+=n;var r=Math.easeInOutQuad(u,l,s,t);i(r),u<t?o(e):a&&"function"===typeof a&&a()};c()}},"1b3f":function(e,t,a){},"903ce":function(e,t,a){"use strict";a("1b3f")},"9fc5":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"根据房间号查找"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.number,callback:function(t){e.$set(e.listQuery,"number",t)},expression:"listQuery.number"}}),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"根据房间名查找"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}}),a("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"房间状态",clearable:""},model:{value:e.listQuery.status,callback:function(t){e.$set(e.listQuery,"status",t)},expression:"listQuery.status"}},[a("el-option",{attrs:{label:"空",value:10}}),a("el-option",{attrs:{label:"已预定",value:20}})],1),a("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"房间类别",clearable:""},model:{value:e.listQuery.category,callback:function(t){e.$set(e.listQuery,"category",t)},expression:"listQuery.category"}},[a("el-option",{attrs:{label:"钟点房",value:1}}),a("el-option",{attrs:{label:"民宿",value:10}}),a("el-option",{attrs:{label:"公寓",value:10}}),a("el-option",{attrs:{label:"电竞宾馆",value:10}})],1),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(" 搜索 ")]),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.handleReset}},[e._v(" 重置 ")]),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v(" 增加 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""},on:{"sort-change":e.sortChange}},[a("el-table-column",{attrs:{label:"ID",prop:"id",sortable:"custom",align:"center","class-name":e.getSortClass("id")},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.id))])]}}])}),a("el-table-column",{attrs:{label:"房间号",prop:"number",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.number))])]}}])}),a("el-table-column",{attrs:{label:"房间名称",prop:"name",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.name))])]}}])}),a("el-table-column",{attrs:{label:"房间简介",prop:"intro",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.intro))])]}}])}),a("el-table-column",{attrs:{label:"房间类别",prop:"category",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.category))])]}}])}),a("el-table-column",{attrs:{label:"价格",prop:"price",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.price))])]}}])}),a("el-table-column",{attrs:{label:"评分",width:"170px",prop:"score",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("el-rate",{attrs:{disabled:""},model:{value:o.score,callback:function(t){e.$set(o,"score",t)},expression:"row.score"}})]}}])}),a("el-table-column",{attrs:{label:"房间状态",prop:"status",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("el-tag",{attrs:{type:10===o.status?"success":"warning"}},[e._v(" "+e._s(10===o.status?"空闲":20===o.status?"已预定":"已入住")+" ")])]}}])}),a("el-table-column",{attrs:{label:"房间详情",prop:"detail",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.detail))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row,i=t.$index;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate(o)}}},[e._v(" 编辑 ")]),"deleted"!=o.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(o,i)}}},[e._v(" 删除 ")]):e._e()]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.pageNum,limit:e.pageSize},on:{"update:page":function(t){e.pageNum=t},"update:limit":function(t){e.pageSize=t},pagination:e.getList}}),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:e.rules,model:e.roomForm,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"房间号",prop:"number"}},[a("el-input",{model:{value:e.roomForm.number,callback:function(t){e.$set(e.roomForm,"number",t)},expression:"roomForm.number"}})],1),a("el-form-item",{attrs:{label:"房间名称",prop:"name"}},[a("el-input",{model:{value:e.roomForm.name,callback:function(t){e.$set(e.roomForm,"name",t)},expression:"roomForm.name"}})],1),a("el-form-item",{attrs:{label:"房间类别",prop:"category"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择房间类别"},model:{value:e.roomForm.category,callback:function(t){e.$set(e.roomForm,"category",t)},expression:"roomForm.category"}},[a("el-option",{attrs:{label:"大床房",value:"1"}}),a("el-option",{attrs:{label:"巨幕房",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"房间简介",prop:"intro"}},[a("el-input",{model:{value:e.roomForm.intro,callback:function(t){e.$set(e.roomForm,"intro",t)},expression:"roomForm.intro"}})],1),a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("el-input",{attrs:{type:"number"},model:{value:e.roomForm.price,callback:function(t){e.$set(e.roomForm,"price",t)},expression:"roomForm.price"}})],1),a("el-form-item",{attrs:{label:"评分",prop:"score"}},[a("el-rate",{model:{value:e.roomForm.score,callback:function(t){e.$set(e.roomForm,"score",t)},expression:"roomForm.score"}})],1),a("el-form-item",{attrs:{label:"房间状态",prop:"status"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择房间状态"},model:{value:e.roomForm.status,callback:function(t){e.$set(e.roomForm,"status",t)},expression:"roomForm.status"}},[a("el-option",{attrs:{label:"空闲",value:10}}),a("el-option",{attrs:{label:"已预定",value:20}})],1)],1),a("el-form-item",{attrs:{label:"房间详情",prop:"detail"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.roomForm.detail,expression:"roomForm.detail"}],attrs:{cols:"50",rows:"5"},domProps:{value:e.roomForm.detail},on:{input:function(t){t.target.composing||e.$set(e.roomForm,"detail",t.target.value)}}})]),a("el-form-item",{attrs:{label:"房间照片",prop:"mainImage"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"",limit:1,"before-upload":e.handleUpload,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.fileList,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传jpg/png文件，且不超过500kb ")])],1)],1),a("el-form-item",{attrs:{label:"其他照片",prop:"subImages"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"","before-upload":e.handleUpload1,"on-remove":e.handleRemove1,"file-list":e.fileList1,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传jpg/png文件，且不超过500kb ")])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" 取消 ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v(" 提交 ")])],1)],1),a("el-dialog",{attrs:{visible:e.dialogPvVisible,title:"Reading statistics"},on:{"update:visible":function(t){e.dialogPvVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.pvData,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"key",label:"Channel"}}),a("el-table-column",{attrs:{prop:"pv",label:"Pv"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogPvVisible=!1}}},[e._v("Confirm")])],1)],1)],1)},i=[],r=(a("4160"),a("a15b"),a("a434"),a("a9e3"),a("ac1f"),a("1276"),a("159b"),a("ed08"),a("333d")),l=a("b775");function s(e){return Object(l["a"])({url:"/admin/room/upload.do",method:"upload",data:e})}function n(e){return Object(l["a"])({url:"/admin/room/get_room_list.do",method:"post",data:e})}function u(e){return Object(l["a"])({url:"/admin/room/update_room.do",method:"post",data:e})}function c(e){return Object(l["a"])({url:"/admin/room/add_room.do",method:"post",data:e})}function m(e){return Object(l["a"])({url:"/admin/room/get_room_by_attribute.do",method:"post",data:e})}var d={name:"RoomTable",components:{Pagination:r["a"]},data:function(){return{roomData:[],roomForm:{number:"",name:"",intro:"",category:"",price:"",score:0,status:10,detail:"",mainImage:"",subImages:""},roomId:0,loading:!1,pageNum:1,pageSize:10,fileList:[],fileList1:[],tableKey:0,list:null,total:0,listLoading:!0,listQuery:{number:"",name:"",category:"",status:10},importanceOptions:[1,2,3],sortOptions:[{label:"ID Ascending",key:"+id"},{label:"ID Descending",key:"-id"}],statusOptions:["published","draft","deleted"],showReviewer:!1,dialogFormVisible:!1,dialogStatus:"",textMap:{update:"更新房间信息",create:"增加房间"},dialogPvVisible:!1,pvData:[],rules:{number:[{required:!0,message:"此项为必填项",trigger:"blur"}],name:[{required:!0,message:"此项为必填项",trigger:"blur"}],intro:[{required:!0,message:"此项为必填项",trigger:"blur"}],category:[{required:!0,message:"此项为必填项",trigger:"blur"}],price:[{required:!0,message:"此项为必填项",trigger:"blur"}],score:[{required:!0,message:"此项为必填项",trigger:"blur"}],status:[{required:!0,message:"此项为必填项",trigger:"blur"}],detail:[{required:!0,message:"此项为必填项",trigger:"blur"}]},dialogVisible:!1,disabled:!0}},mounted:function(){this.getList()},methods:{handleUpload:function(e){var t=this;if("image/jpeg"===e.type||"image/png"===e.type){if(this.fileList.length>=1)return void this.$message.error("主要照片只能上传一张");var a=new FormData;return a.append("upload_file",e),s(a).then((function(e){0===e.status&&t.fileList.push({name:e.uri,url:e.url}),t.loading=!1})).catch((function(e){t.loading=!1,console.error(e)})),!1}return this.$message.error("上传图片只能是 JPG/PNG 格式!"),!1},handleUpload1:function(e){var t=this;if("image/jpeg"===e.type||"image/png"===e.type){var a=new FormData;return a.append("upload_file",e),s(a).then((function(e){0===e.status&&t.fileList1.push({name:e.uri,url:e.url})})),!1}return this.$message.error("上传图片只能是 JPG/PNG 格式!"),!1},handleRemove:function(e,t){var a=this;this.fileList.forEach((function(t,o){e.url===t.url&&a.fileList.splice(o,1)}))},handlePreview:function(e){console.log(e)},handleRemove1:function(e,t){var a=this;this.fileList1.forEach((function(t,o){e.url===t.url&&a.fileList1.splice(o,1)}))},handlePreview1:function(e){console.log(e)},getList:function(){var e=this;this.listLoading=!0;var t={pageNum:this.pageNum,pageSize:this.pageSize};n(t).then((function(t){e.list=t.data.list,e.total=t.data.total,e.listLoading=!1})).catch((function(t){e.listLoading=!1}))},handleFilter:function(){var e=this;this.pageNum=1,this.listLoading=!0;var t={room:this.listQuery,pageNum:this.pageNum,pageSize:this.pageSize};m(t).then((function(t){e.list=t.data.list,e.total=t.data.total,e.listLoading=!1})).catch((function(t){e.listLoading=!1}))},handleModifyStatus:function(e,t){this.$message({message:"操作Success",type:"success"}),e.status=t},sortChange:function(e){var t=e.prop,a=e.order;"id"===t&&this.sortByID(a)},sortByID:function(e){this.listQuery.sort="ascending"===e?"+id":"-id",this.handleFilter()},resetTemp:function(){this.roomForm={number:"",name:"",intro:"",category:"",price:"",score:0,status:10,detail:"",mainImage:"",subImages:""}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},handleReset:function(){this.listQuery={id:"",name:"",status:"",type:""},this.getList()},createData:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){if(!e.fileList.length||!e.fileList1.length)return void e.$message.warning("请上传图片后进行确认");e.roomForm.price=Number(e.roomForm.price),e.roomForm.mainImage=e.fileList[0].url;var a=[];e.fileList1.forEach((function(e){a.push(e.url)})),e.roomForm.subImages=a.join(","),c(e.roomForm).then((function(t){0===t.status?(e.$message({type:"success",message:"添加成功"}),e.fileList1=[],e.fileList=[],e.dialogFormVisible=!1,e.getList()):e.$message.error(t.msg)}))}}))},handleUpdate:function(e){var t=this;this.roomForm=Object.assign({},e),this.roomId=e.id,this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()})),this.fileList.push({url:e.mainImage}),e.subImages.split(",").forEach((function(e){t.fileList1.push({url:e})}))},updateData:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){if(!e.fileList.length||!e.fileList1.length)return void e.$message.warning("请上传图片后进行确认");e.roomForm.price=Number(e.roomForm.price),e.roomForm.mainImage=e.fileList[0].url;var a=[];e.fileList1.forEach((function(e){a.push(e.url)})),e.roomForm.subImages=a.join(",");var o={id:e.roomId};Object.assign(o,e.roomForm),u(o).then((function(t){0===t.status?(e.$message({type:"success",message:"更新成功"}),e.fileList1=[],e.fileList=[],e.dialogFormVisible=!1,e.getList()):e.$message.error(t.msg)}))}}))},handleDelete:function(e,t){this.$notify({title:"Success",message:"Delete Successfully",type:"success",duration:2e3}),this.list.splice(t,1)},getSortClass:function(e){var t=this.listQuery.sort;return t==="+".concat(e)?"ascending":"descending"}}},p=d,f=(a("903ce"),a("2877")),g=Object(f["a"])(p,o,i,!1,null,"9cdd393c",null);t["default"]=g.exports}}]);